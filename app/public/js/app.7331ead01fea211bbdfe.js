webpackJsonp([1],{BQGX:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("7+uW"),r=a("NYxO"),i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var o=a("VU/8")({name:"App"},i,!1,function(e){a("VC28")},null,null).exports,s=a("/ocq"),l=a("d7EF"),u=a.n(l),c=a("//Fk"),m=a.n(c),d=a("Dd8w"),f=a.n(d),p={name:"Layout",props:["activeIndex"],data:function(){return{userInfo:{}}},methods:f()({},Object(r.b)(["LOGOUT"]),{clickItem:function(e){switch(e){case"modify":this.$router.push("/modifyPassword");break;case"logout":location.href="/api/auth/logout"}}}),computed:f()({},Object(r.c)(["user"]))},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticStyle:{color:"#fff","font-size":"16px","background-color":"#24292e"}},[a("el-dropdown",{on:{command:e.clickItem}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n        "+e._s(e.user.userInfo.nickname)),a("i",{staticClass:"el-icon-caret-bottom",staticStyle:{"margin-left":"8px","margin-right":"8px","font-size":"14px"}})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"modify"}},[e._v("修改密码")]),e._v(" "),a("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出登录")])],1)],1),e._v(" "),a("h3",{staticClass:"title"},[e._v("管理系统")])],1),e._v(" "),a("el-container",[a("el-aside",{attrs:{width:"180px"}},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activeIndex}},[a("el-menu-item",{attrs:{index:"main"}},[a("i",{staticClass:"el-icon-menu"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[a("router-link",{attrs:{to:"/main"}},[e._v("今日菜单")])],1)]),e._v(" "),1===e.user.userInfo.role_id?a("el-submenu",{attrs:{index:"role"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-location"}),e._v(" "),a("span",[e._v("角色管理")])]),e._v(" "),a("el-menu-item",{attrs:{index:"roleList"}},[a("router-link",{attrs:{to:"/roleList"}},[e._v("角色列表")])],1)],2):e._e(),e._v(" "),1===e.user.userInfo.role_id?a("el-submenu",{attrs:{index:"user"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-location"}),e._v(" "),a("span",[e._v("用户管理")])]),e._v(" "),a("el-menu-item",{attrs:{index:"userList"}},[a("router-link",{attrs:{to:"/userList"}},[e._v("用户列表")])],1)],2):e._e(),e._v(" "),1===e.user.userInfo.role_id?a("el-submenu",{attrs:{index:"dinner"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-location"}),e._v(" "),a("span",[e._v("订餐管理")])]),e._v(" "),a("el-menu-item-group",[a("el-menu-item",{attrs:{index:"menuList"}},[a("router-link",{attrs:{to:"/menuList"}},[e._v("菜单列表")])],1),e._v(" "),a("el-menu-item",{attrs:{index:"mealList"}},[a("router-link",{attrs:{to:"/mealList"}},[e._v("菜式列表")])],1),e._v(" "),a("el-menu-item",{attrs:{index:"orderList"}},[a("router-link",{attrs:{to:"/orderList"}},[e._v("订单列表")])],1)],1)],2):e._e()],1)],1),e._v(" "),a("el-main",[e._t("default")],2)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(p,g,!1,function(e){a("QxQ/")},"data-v-e5daee7c",null).exports,v=a("mtWM"),b=a.n(v);b.a.defaults.timeout=1e4,b.a.defaults.baseURL="/api",b.a.interceptors.response.use(function(e){return 200===e.data.code?(console.table(e.data),e):m.a.reject(e.data)},function(e){return console.table(e),m.a.reject(new Error(e.response.data.error||e.message))});var _=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new m.a(function(a,n){b.a.get(e,{params:t}).then(function(e){a(e.data)}).catch(function(e){n(e)})})},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new m.a(function(a,n){b.a.post(e,t).then(function(e){a(e.data)}).catch(function(e){n(e)})})},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new m.a(function(a,n){b.a.put(e,t).then(function(e){a(e.data)}).catch(function(e){n(e)})})},w=function(e){return new m.a(function(t,a){b.a.delete(e,{}).then(function(e){t(e.data)}).catch(function(e){a(e)})})},z=function(e){return _("/meals",e)},x=function(){return _("/getMealslastest")},S=function(e){return _("/orders",e)},L=function(e){return k("/orders",e)},$=function(e,t){return y("/orders/"+e,t)},C={name:"Main",components:{layout:h},data:function(){return{order:{},mealList:[],checkedMeals:[]}},mounted:function(){var e=this;m.a.all([_("/getOrderByUserName"),x()]).then(function(t){var a=u()(t,2),n=a[0],r=a[1];r.data.count>0&&(e.mealList=r.data.rows),n.data&&(e.order=n.data,e.checkedMeals=n.data.meal_list.split(","))}).catch(function(t){e.$message.error(t.message)})},methods:{takeOrder:function(){var e=this;if(this.order.id){if(0===this.checkedMeals.length)return void this.$message.error("请至少选择一个菜");$(this.order.id,{meal_list:this.checkedMeals.join(",")}).then(function(t){e.$message({type:"success",message:t.msg})}).catch(function(t){e.$message.error(t.message)})}else{if(0===this.checkedMeals.length)return void this.$message.error("请至少选择一个菜");L({meal_list:this.checkedMeals.join(",")}).then(function(t){e.$message({type:"success",message:t.msg}),e.order=t.data}).catch(function(t){e.$message.error(t.message)})}}}},M={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout",{attrs:{"active-index":"main"}},[a("h3",[e._v("今日菜单")]),e._v(" "),a("el-checkbox-group",{model:{value:e.checkedMeals,callback:function(t){e.checkedMeals=t},expression:"checkedMeals"}},e._l(e.mealList,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.name}},[e._v(e._s(t.name))])})),e._v(" "),a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:e.takeOrder}},[e._v("点餐")])],1)},staticRenderFns:[]};var F=a("VU/8")(C,M,!1,function(e){a("XlyW")},"data-v-8410698e",null).exports,U=function(e){return _("/users",e)},A=function(e,t){return y("/users/"+e,t)},O={name:"Login",data:function(){return{ruleForm:{name:"",password:""},isPass:!1,labelPosition:"right",rules:{name:[{required:!0,message:"请输入账号名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:f()({},Object(r.b)(["LOGIN"]),{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(a={name:t.ruleForm.name,password:t.ruleForm.password},k("/auth/login",a)).then(function(e){200===e.code?(t.LOGIN(e.data),t.$router.push(t.$route.query.redirect||"/main")):t.$message.error(e.msg)}).catch(function(e){t.$message.error(e.message)})})},clearForm:function(e){this.$refs[e].resetFields(),this.isPass=!1}})},V={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"loginPage"},[a("div",{staticClass:"form"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"ruleForm",attrs:{label:"","label-position":e.labelPosition,"label-width":"100px",model:e.ruleForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"账 号",prop:"name"}},[a("el-input",{attrs:{type:"text"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("ruleForm")}},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{color:"#fff"},attrs:{label:"密 码",prop:"password"}},[a("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("ruleForm")}},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("登 录")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(t){e.clearForm("ruleForm")}}},[e._v("重 置")])],1)],1)],1)],1)],1)])},staticRenderFns:[]};var P=a("VU/8")(O,V,!1,function(e){a("nhwv")},"data-v-39e151d2",null).exports,D=function(e){return _("/roles",e)},R={name:"RoleList",components:{layout:h},data:function(){return{roleList:[],roleCount:0,currentPage:0,pageSize:10,dialogAddRoleVisible:!1,dialogUpdateRoleVisible:!1,form:{name:""},curId:0}},mounted:function(){this.getRoleList({pageNum:this.currentPage+1,pageSize:this.pageSize})},methods:{handleAdd:function(){var e,t=this;this.form.name?(e=this.form,k("/roles",e)).then(function(e){t.dialogAddRoleVisible=!1,t.form.name="",t.$message({type:"success",message:e.msg}),t.getRoleList({pageNum:Math.ceil((t.roleCount+1)/t.pageSize),pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)}):this.$message.error("请输入角色名称")},showUpdateRoleDialog:function(e){this.dialogUpdateRoleVisible=!0,this.form.name=e.name,this.curId=e.id},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e.id,w("/roles/"+a)).then(function(e){t.$message({type:"success",message:e.msg}),t.getRoleList({pageNum:Math.ceil(t.roleCount/t.pageSize)===Math.ceil((t.roleCount-1)/t.pageSize)?t.currentPage:t.currentPage-1,pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})}).catch(function(e){console.log(e)})},handleUpdate:function(){var e,t,a=this;this.dialogUpdateRoleVisible=!1,form.name="",this.form.name?(e=this.curId,t=this.form,y("/roles/"+e,t)).then(function(e){a.$message({type:"success",message:e.msg}),a.getRoleList({pageNum:a.currentPage,pageSize:a.pageSize})}).catch(function(e){a.$message.error(e.message)}):this.$message.error("角色名称不能为空")},getRoleList:function(e){var t=this;D(e).then(function(a){a.data.rows.length>0&&(t.roleList=a.data.rows,t.roleCount=a.data.count,t.currentPage=e.currentPage)}).catch(function(e){t.$message.error(e.message)})},pageChange:function(e){this.getRoleList({pageNum:e,pageSize:this.pageSize})},pageSizeChange:function(e){this.pageSize=e,this.getRoleList({pageNum:1,pageSize:this.pageSize})}}},I={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout",{attrs:{"active-index":"roleList"}},[a("h3",{staticClass:"title"},[e._v("角色列表"),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){e.dialogAddRoleVisible=!0}}},[e._v("新增角色")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roleList,stripe:"","highlight-current-row":!0}},[a("el-table-column",{attrs:{prop:"id",label:"编号",sortable:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"角色名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.showUpdateRoleDialog(t.row)}}},[a("i",{staticClass:"iconfont icon-details"}),e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleDelete(t.row)}}},[a("i",{staticClass:"iconfont icon-delete"}),e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{layout:"prev, pager, next, jumper, ->, sizes, total",total:e.roleCount,background:!0,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[5,10,20,50,100]},on:{"current-change":e.pageChange,"size-change":e.pageSizeChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"新增角色",visible:e.dialogAddRoleVisible,width:"40%"},on:{"update:visible":function(t){e.dialogAddRoleVisible=t}}},[a("el-form",{attrs:{model:e.form},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"角色名称","label-width":"80px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogAddRoleVisible=!1,e.form.name=""}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改角色",visible:e.dialogUpdateRoleVisible,width:"40%"},on:{"update:visible":function(t){e.dialogUpdateRoleVisible=t}}},[a("el-form",{attrs:{model:e.form},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"角色名称","label-width":"80px"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogUpdateRoleVisible=!1,e.form.name=""}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleUpdate}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var N=a("VU/8")(R,I,!1,function(e){a("BQGX")},"data-v-dcc046e6",null).exports,q={name:"UserList",components:{layout:h},data:function(){return{userList:[],roleList:[],userCount:0,currentPage:0,pageSize:10,dialogAddUserVisible:!1,form:{name:"",password:"",nickname:"",email:"",role_id:1},rules:{name:[{required:!0,message:"请输入账号名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],email:[{type:"email",message:"输入邮箱格式不正确",trigger:"blur"}],role_id:[{required:!0,message:"请选择用户角色",trigger:"blur"}]}}},mounted:function(){var e=this,t={pageNum:this.currentPage+1,pageSize:this.pageSize};m.a.all([D(),U(t)]).then(function(a){var n=u()(a,2),r=n[0],i=n[1];r.data.rows.length>0&&(e.roleList=r.data.rows),i.data.rows.length>0&&(e.userList=i.data.rows,e.userCount=i.data.count,e.currentPage=t.currentPage)}).catch(function(t){e.$message.error(t.message)})},methods:{getUserList:function(e){var t=this;U(e).then(function(a){a.data.rows.length>0&&(t.userList=a.data.rows,t.userCount=a.data.count,t.currentPage=e.currentPage)}).catch(function(e){t.$message.error(e.message)})},formatStatus:function(e,t,a){return this.roleList.filter(function(e){return e.id===a})[0].name},closeAddUserDialog:function(e){this.$refs[e].resetFields(),this.dialogAddUserVisible=!1},handleAdd:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(a=t.form,k("/users",a)).then(function(e){t.closeAddUserDialog("addUserForm"),t.$message({type:"success",message:e.msg}),t.getUserList({pageNum:Math.ceil((t.userCount+1)/t.pageSize),pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})})},handleDetail:function(e){this.$router.push("/user/"+e.id)},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e.id,w("/users/"+a)).then(function(e){t.$message({type:"success",message:e.msg}),t.getUserList({pageNum:Math.ceil(t.userCount/t.pageSize)===Math.ceil((t.userCount-1)/t.pageSize)?t.currentPage:t.currentPage-1,pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})}).catch(function(e){console.log(e)})},pageChange:function(e){this.getUserList({pageNum:e,pageSize:this.pageSize})},pageSizeChange:function(e){this.pageSize=e,this.getUserList({pageNum:1,pageSize:this.pageSize})}}},E={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout",{attrs:{"active-index":"userList"}},[a("h3",{staticClass:"title"},[e._v("用户列表"),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){e.dialogAddUserVisible=!0}}},[e._v("新增用户")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList,stripe:"","highlight-current-row":!0}},[a("el-table-column",{attrs:{prop:"id",label:"编号",sortable:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nickname",label:"昵称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"role_id",label:"角色",formatter:e.formatStatus,align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleDetail(t.row)}}},[a("i",{staticClass:"iconfont icon-details"}),e._v("查看")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleDelete(t.row)}}},[a("i",{staticClass:"iconfont icon-delete"}),e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{layout:"prev, pager, next, jumper, ->, sizes, total",total:e.userCount,background:!0,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[5,10,20,50,100]},on:{"current-change":e.pageChange,"size-change":e.pageSizeChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"新增用户",visible:e.dialogAddUserVisible,width:"40%"},on:{"update:visible":function(t){e.dialogAddUserVisible=t}}},[a("el-form",{ref:"addUserForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名称","label-width":"80px",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAdd("addUserForm")}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户密码","label-width":"80px",prop:"password"}},[a("el-input",{attrs:{"auto-complete":"off",type:"password"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAdd("addUserForm")}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户昵称","label-width":"80px",prop:"nickname"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAdd("addUserForm")}},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户邮箱","label-width":"80px",prop:"email"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAdd("addUserForm")}},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户角色","label-width":"80px",prop:"role_id"}},[a("el-radio-group",{model:{value:e.form.role_id,callback:function(t){e.$set(e.form,"role_id",t)},expression:"form.role_id"}},e._l(e.roleList,function(t){return a("el-radio",{key:t.id,attrs:{label:t.id}},[e._v("\n            "+e._s(t.name)+"\n          ")])}))],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"right"},attrs:{label:""}},[a("el-button",{on:{click:function(t){e.closeAddUserDialog("addUserForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleAdd("addUserForm")}}},[e._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[]};var j=a("VU/8")(q,E,!1,function(e){a("b46R")},"data-v-a75780ae",null).exports,B={name:"UserDetail",components:{layout:h},data:function(){return{roleList:[],form:{name:"",nickname:"",role_id:0,email:""},rules:{name:[{required:!0,message:"请输入账号名",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],email:[{type:"email",message:"输入邮箱格式不正确",trigger:"blur"}],role_id:[{required:!0,message:"请选择用户角色",trigger:"blur"}]}}},mounted:function(){var e,t=this;m.a.all([D(),(e=this.$route.params.id,_("/users/"+e))]).then(function(e){var a=u()(e,2),n=a[0],r=a[1];n.data.rows.length>0&&(t.roleList=n.data.rows),r.data&&(t.form=r.data)}).catch(function(e){t.$message.error(e.message)})},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){e&&A(t.$route.params.id,t.form).then(function(e){t.$message({type:"success",message:e.msg})}).catch(function(e){t.$message.error(e.message)})})}}},T={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout",{attrs:{"active-index":"userList"}},[a("h3",{staticClass:"title"},[e._v("用户详情")]),e._v(" "),a("el-form",{ref:"updateUserForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"用户名称","label-width":"80px",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("updateUserForm")}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户昵称","label-width":"80px",prop:"nickname"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("updateUserForm")}},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户邮箱","label-width":"80px",prop:"email"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("updateUserForm")}},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户角色","label-width":"80px",prop:"role_id"}},[a("el-radio-group",{model:{value:e.form.role_id,callback:function(t){e.$set(e.form,"role_id",t)},expression:"form.role_id"}},e._l(e.roleList,function(t){return a("el-radio",{key:t.id,attrs:{label:t.id}},[e._v("\n            "+e._s(t.name)+"\n          ")])}))],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"right"},attrs:{label:""}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("updateUserForm")}}},[e._v("确定修改")])],1)],1)],1)},staticRenderFns:[]};var G=a("VU/8")(B,T,!1,function(e){a("R4VL")},"data-v-0037f016",null).exports,Q={name:"ModifyPassword",components:{layout:h},data:function(){var e=this;return{form:{password:"",confirm_password:""},rules:{password:[{validator:function(t,a,n){""===a?n(new Error("请输入新密码")):(""!==e.form.confirm_password&&e.$refs.updateUserForm.validateField("confirm_password"),n())},trigger:"blur"}],confirm_password:[{validator:function(t,a,n){""===a?n(new Error("请再次输入新密码")):a!==e.form.password?n(new Error("两次输入密码不一致!")):n()},trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){e&&A(t.user.userInfo.id,t.form).then(function(e){t.$message({type:"success",message:e.msg}),t.$router.push("/main")}).catch(function(e){t.$message.error(e.message)})})}},computed:f()({},Object(r.c)(["user"]))},H={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout",{attrs:{"active-index":"userList"}},[a("h3",{staticClass:"title"},[e._v("修改密码")]),e._v(" "),a("el-form",{ref:"updateUserForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"新密码","label-width":"80px",prop:"password"}},[a("el-input",{attrs:{"auto-complete":"off",type:"password"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("updateUserForm")}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码","label-width":"80px",prop:"confirm_password"}},[a("el-input",{attrs:{"auto-complete":"off",type:"password"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("updateUserForm")}},model:{value:e.form.confirm_password,callback:function(t){e.$set(e.form,"confirm_password",t)},expression:"form.confirm_password"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"right"},attrs:{label:""}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("updateUserForm")}}},[e._v("确定修改")])],1)],1)],1)},staticRenderFns:[]};var W=a("VU/8")(Q,H,!1,function(e){a("V4Dg")},"data-v-2e1661b8",null).exports,X=function(e){return _("/menus",e)},J={name:"MenuList",components:{layout:h},data:function(){return{menuList:[],menuCount:0,currentPage:0,pageSize:10,dialogAddMenuVisible:!1,dialogUpdateMenuVisible:!1,form:{name:"",phone:"",enabled:!1},rules:{name:[{required:!0,message:"请输入菜单名",trigger:"blur"}]},curId:0}},mounted:function(){this.getMenuList({pageNum:this.currentPage+1,pageSize:this.pageSize})},methods:{closeDialog:function(e){switch(this.form.name="",this.form.phone="",this.form.enabled=!1,this.curId=0,e){case"addMenuForm":this.dialogAddMenuVisible=!1;break;case"updateMenuForm":this.dialogUpdateMenuVisible=!1}},handleAdd:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(a=t.form,k("/menus",a)).then(function(e){t.closeDialog("addMenuForm"),t.$message({type:"success",message:e.msg}),t.getMenuList({pageNum:Math.ceil((t.menuCount+1)/t.pageSize),pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})})},showUpdateMenuDialog:function(e){var t=e.name,a=e.phone,n=e.enabled,r=e.id;this.form.name=t,this.form.phone=a,this.form.enabled=n,this.curId=r,this.dialogUpdateMenuVisible=!0},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该菜单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e.id,w("/menus/"+a)).then(function(e){t.$message({type:"success",message:e.msg}),t.getMenuList({pageNum:Math.ceil(t.menuCount/t.pageSize)===Math.ceil((t.menuCount-1)/t.pageSize)?t.currentPage:t.currentPage-1,pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})}).catch(function(e){console.log(e)})},handleUpdate:function(e){var t=this;this.$refs[e].validate(function(e){var a,n;e&&(a=t.curId,n=t.form,y("/menus/"+a,n)).then(function(e){t.closeDialog("updateMenuForm"),t.$message({type:"success",message:e.msg}),t.getMenuList({pageNum:t.currentPage,pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})})},getMenuList:function(e){var t=this;X(e).then(function(a){a.data.rows.length>0&&(t.menuList=a.data.rows,t.menuCount=a.data.count,t.currentPage=e.currentPage)}).catch(function(e){t.$message.error(e.message)})},pageChange:function(e){this.getMenuList({pageNum:e,pageSize:this.pageSize})},pageSizeChange:function(e){this.pageSize=e,this.getMenuList({pageNum:1,pageSize:this.pageSize})},formatStatus:function(e,t,a){return a?"已启用":"已禁用"}}},Y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout",{attrs:{"active-index":"menuList"}},[a("h3",{staticClass:"title"},[e._v("菜单列表"),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){e.dialogAddMenuVisible=!0}}},[e._v("新增菜单")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.menuList,stripe:"","highlight-current-row":!0}},[a("el-table-column",{attrs:{prop:"id",label:"编号",sortable:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"菜单名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"联系电话",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"enabled",label:"菜单状态",align:"center",formatter:e.formatStatus}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.showUpdateMenuDialog(t.row)}}},[a("i",{staticClass:"iconfont icon-details"}),e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleDelete(t.row)}}},[a("i",{staticClass:"iconfont icon-delete"}),e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{layout:"prev, pager, next, jumper, ->, sizes, total",total:e.menuCount,background:!0,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[5,10,20,50,100]},on:{"current-change":e.pageChange,"size-change":e.pageSizeChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"新增菜单",visible:e.dialogAddMenuVisible,width:"40%"},on:{"update:visible":function(t){e.dialogAddMenuVisible=t}}},[a("el-form",{ref:"addMenuForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"菜单名称","label-width":"80px",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAdd("addMenuForm")}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话","label-width":"80px",prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAdd("addMenuForm")}},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"菜单状态","label-width":"80px",prop:"enabled"}},[a("el-switch",{model:{value:e.form.enabled,callback:function(t){e.$set(e.form,"enabled",t)},expression:"form.enabled"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.closeDialog("addMenuForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleAdd("addMenuForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改菜单",visible:e.dialogUpdateMenuVisible,width:"40%"},on:{"update:visible":function(t){e.dialogUpdateMenuVisible=t}}},[a("el-form",{ref:"updateMenuForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"菜单名称","label-width":"80px",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAdd("updateMenuForm")}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话","label-width":"80px",prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAdd("updateMenuForm")}},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"菜单状态","label-width":"80px",prop:"enabled"}},[a("el-switch",{model:{value:e.form.enabled,callback:function(t){e.$set(e.form,"enabled",t)},expression:"form.enabled"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.closeDialog("updateMenuForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleUpdate("updateMenuForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var K,Z=a("VU/8")(J,Y,!1,function(e){a("VHQn")},"data-v-24c7783e",null).exports,ee=a("bOdI"),te=a.n(ee),ae={name:"MealList",components:{layout:h},data:function(){return{mealList:[],menuList:[],mealCount:0,currentPage:0,pageSize:10,dialogAddMealVisible:!1,dialogUpdateMealVisible:!1,form:{name:"",menu_id:""},rules:{name:[{required:!0,message:"请输入菜品名",trigger:"blur"}],menu_id:[{required:!0,message:"请选择一个菜单",trigger:"blur"}]},curId:0}},mounted:function(){var e=this,t={pageNum:this.currentPage+1,pageSize:this.pageSize};m.a.all([X(),z(t)]).then(function(a){var n=u()(a,2),r=n[0],i=n[1];r.data.rows.length>0&&(e.menuList=r.data.rows),i.data.rows.length>0&&(e.mealList=i.data.rows,e.mealCount=i.data.count,e.currentPage=t.currentPage)}).catch(function(t){e.$message.error(t.message)})},methods:(K={getMealList:function(e){var t=this;z(e).then(function(a){a.data.rows.length>0&&(t.mealList=a.data.rows,t.mealCount=a.data.count,t.currentPage=e.currentPage)}).catch(function(e){t.$message.error(e.message)})},formatStatus:function(e,t,a){return this.menuList.filter(function(e){return e.id===a})[0].name},closeDialog:function(e){switch(this.form.name="",this.form.phone="",this.form.enabled=!1,this.curId=0,e){case"addMealForm":this.dialogAddMealVisible=!1;break;case"updateMealForm":this.dialogUpdateMealVisible=!1}},handleAdd:function(e){var t=this;this.$refs[e].validate(function(e){var a;e&&(a=t.form,k("/meals",a)).then(function(e){t.closeDialog("addMealForm"),t.$message({type:"success",message:e.msg}),t.getMealList({pageNum:Math.ceil((t.mealCount+1)/t.pageSize),pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})})},showUpdateMealDialog:function(e){var t=e.name,a=e.phone,n=e.enabled,r=e.id;this.form.name=t,this.form.phone=a,this.form.enabled=n,this.curId=r,this.dialogUpdateMealVisible=!0},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该菜品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e.id,w("/meals/"+a)).then(function(e){t.$message({type:"success",message:e.msg}),t.getMealList({pageNum:Math.ceil(t.mealCount/t.pageSize)===Math.ceil((t.mealCount-1)/t.pageSize)?t.currentPage:t.currentPage-1,pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})}).catch(function(e){console.log(e)})},handleUpdate:function(e){var t=this;this.$refs[e].validate(function(e){var a,n;e&&(a=t.curId,n=t.form,y("/meals/"+a,n)).then(function(e){t.closeDialog("updateMealForm"),t.$message({type:"success",message:e.msg}),t.getMealList({pageNum:t.currentPage,pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})})}},te()(K,"getMealList",function(e){var t=this;z(e).then(function(a){a.data.rows.length>0&&(t.mealList=a.data.rows,t.mealCount=a.data.count,t.currentPage=e.currentPage)}).catch(function(e){t.$message.error(e.message)})}),te()(K,"pageChange",function(e){this.getMealList({pageNum:e,pageSize:this.pageSize})}),te()(K,"pageSizeChange",function(e){this.pageSize=e,this.getMealList({pageNum:1,pageSize:this.pageSize})}),K)},ne={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout",{attrs:{"active-index":"mealList"}},[a("h3",{staticClass:"title"},[e._v("菜品列表"),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){e.dialogAddMealVisible=!0}}},[e._v("新增菜品")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mealList,stripe:"","highlight-current-row":!0}},[a("el-table-column",{attrs:{prop:"id",label:"编号",sortable:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"menu_id",label:"所属菜品",align:"center",formatter:e.formatStatus}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.showUpdateMealDialog(t.row)}}},[a("i",{staticClass:"iconfont icon-details"}),e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleDelete(t.row)}}},[a("i",{staticClass:"iconfont icon-delete"}),e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{layout:"prev, pager, next, jumper, ->, sizes, total",total:e.mealCount,background:!0,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[5,10,20,50,100]},on:{"current-change":e.pageChange,"size-change":e.pageSizeChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"新增菜品",visible:e.dialogAddMealVisible,width:"40%"},on:{"update:visible":function(t){e.dialogAddMealVisible=t}}},[a("el-form",{ref:"addMealForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"名称","label-width":"80px",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAdd("addMealForm")}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属菜品","label-width":"80px",prop:"menu_id"}},[a("el-select",{attrs:{placeholder:"请选择菜单"},model:{value:e.form.menu_id,callback:function(t){e.$set(e.form,"menu_id",t)},expression:"form.menu_id"}},e._l(e.menuList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.closeDialog("addMealForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleAdd("addMealForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改菜品",visible:e.dialogUpdateMealVisible,width:"40%"},on:{"update:visible":function(t){e.dialogUpdateMealVisible=t}}},[a("el-form",{ref:"updateMealForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"名称","label-width":"80px",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleAdd("updateMealForm")}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属菜品","label-width":"80px",prop:"menu_id"}},[a("el-select",{attrs:{placeholder:"请选择菜单"},model:{value:e.form.menu_id,callback:function(t){e.$set(e.form,"menu_id",t)},expression:"form.menu_id"}},e._l(e.menuList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.closeDialog("updateMealForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleUpdate("updateMealForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var re=a("VU/8")(ae,ne,!1,function(e){a("m1VC")},"data-v-221d3006",null).exports,ie=(a("OMJi"),{name:"OrderList",components:{layout:h},data:function(){return{orderList:[],mealList:[],userList:[],orderCount:0,currentPage:0,pageSize:10,dialogAddOrderVisible:!1,dialogUpdateOrderVisible:!1,form:{user_name:"",meal_list:[]},rules:{user_name:[{required:!0,message:"请选择一个点餐人",trigger:"blur"}],meal_list:[{required:!0,message:"至少选择一个菜式",trigger:"blur"}]},curId:0}},mounted:function(){var e=this,t={pageNum:this.currentPage+1,pageSize:this.pageSize};m.a.all([x(),U(),S(t)]).then(function(a){var n=u()(a,3),r=n[0],i=n[1],o=n[2];r.data.rows.length>0&&(e.mealList=r.data.rows),i.data.rows.length>0&&(e.userList=i.data.rows),o.data.rows.length>0&&(e.orderList=o.data.rows,e.orderCount=o.data.count,e.currentPage=t.currentPage)}).catch(function(t){e.$message.error(t.message)})},methods:{closeDialog:function(e){switch(this.form.user_name="",this.form.meal_list=[],this.curId=0,e){case"addOrderForm":this.dialogAddOrderVisible=!1;break;case"updateOrderForm":this.dialogUpdateOrderVisible=!1}},handleAdd:function(e){var t=this;this.$refs[e].validate(function(e){e&&L(f()({},t.form,{meal_list:t.form.meal_list.join(",")})).then(function(e){t.closeDialog("addOrderForm"),t.$message({type:"success",message:e.msg}),t.getOrderList({pageNum:Math.ceil((t.orderCount+1)/t.pageSize),pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})})},showUpdateOrderDialog:function(e){var t=e.user_name,a=e.meal_list,n=e.id;this.form.user_name=t,this.form.meal_list=a.split(","),this.curId=n,this.dialogUpdateOrderVisible=!0},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该订单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a;(a=e.id,w("/orders/"+a)).then(function(e){t.$message({type:"success",message:e.msg}),t.getOrderList({pageNum:Math.ceil(t.orderCount/t.pageSize)===Math.ceil((t.orderCount-1)/t.pageSize)?t.currentPage:t.currentPage-1,pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})}).catch(function(e){console.log(e)})},handleUpdate:function(e){var t=this;this.$refs[e].validate(function(e){e&&$(t.curId,f()({},t.form,{meal_list:t.form.meal_list.join(",")})).then(function(e){t.closeDialog("updateOrderForm"),t.$message({type:"success",message:e.msg}),t.getOrderList({pageNum:t.currentPage,pageSize:t.pageSize})}).catch(function(e){t.$message.error(e.message)})})},getOrderList:function(e){var t=this;S(e).then(function(a){a.data.rows.length>0&&(t.orderList=a.data.rows,t.orderCount=a.data.count,t.currentPage=e.currentPage)}).catch(function(e){t.$message.error(e.message)})},pageChange:function(e){this.getOrderList({pageNum:e,pageSize:this.pageSize})},pageSizeChange:function(e){this.pageSize=e,this.getOrderList({pageNum:1,pageSize:this.pageSize})}}}),oe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout",{attrs:{"active-index":"orderList"}},[a("h3",{staticClass:"title"},[e._v("订单列表"),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.dialogAddOrderVisible=!0}}},[e._v("点餐")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderList,stripe:"","highlight-current-row":!0}},[a("el-table-column",{attrs:{prop:"id",label:"编号",sortable:"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user_name",label:"订餐人",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"meal_list",label:"订餐菜式",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.showUpdateOrderDialog(t.row)}}},[a("i",{staticClass:"iconfont icon-details"}),e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.handleDelete(t.row)}}},[a("i",{staticClass:"iconfont icon-delete"}),e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{layout:"prev, pager, next, jumper, ->, sizes, total",total:e.orderCount,background:!0,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[5,10,20,50,100]},on:{"current-change":e.pageChange,"size-change":e.pageSizeChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"点餐",visible:e.dialogAddOrderVisible,width:"40%"},on:{"update:visible":function(t){e.dialogAddOrderVisible=t}}},[a("el-form",{ref:"addOrderForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"订餐人","label-width":"80px",prop:"user_name"}},[a("el-select",{attrs:{placeholder:"请选择订餐人"},model:{value:e.form.user_name,callback:function(t){e.$set(e.form,"user_name",t)},expression:"form.user_name"}},e._l(e.userList,function(e){return a("el-option",{key:e.id,attrs:{label:e.nickname,value:e.nickname}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"订餐菜式","label-width":"80px",prop:"meal_list"}},[a("el-checkbox-group",{model:{value:e.form.meal_list,callback:function(t){e.$set(e.form,"meal_list",t)},expression:"form.meal_list"}},e._l(e.mealList,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.name}},[e._v(e._s(t.name))])}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.closeDialog("addOrderForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleAdd("addOrderForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改订单",visible:e.dialogUpdateOrderVisible,width:"40%"},on:{"update:visible":function(t){e.dialogUpdateOrderVisible=t}}},[a("el-form",{ref:"updateOrderForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"订餐人","label-width":"80px",prop:"user_name"}},[a("el-select",{attrs:{placeholder:"请选择订餐人",disabled:""},model:{value:e.form.user_name,callback:function(t){e.$set(e.form,"user_name",t)},expression:"form.user_name"}},e._l(e.userList,function(e){return a("el-option",{key:e.id,attrs:{label:e.nickname,value:e.nickname}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"订餐菜式","label-width":"80px",prop:"meal_list"}},[a("el-checkbox-group",{model:{value:e.form.meal_list,callback:function(t){e.$set(e.form,"meal_list",t)},expression:"form.meal_list"}},e._l(e.mealList,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.name}},[e._v(e._s(t.name))])}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.closeDialog("updateOrderForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleUpdate("updateOrderForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var se,le=a("VU/8")(ie,oe,!1,function(e){a("kmGr")},"data-v-0f56fe0e",null).exports,ue=a("mvHQ"),ce=a.n(ue),me={state:{userInfo:JSON.parse(localStorage.getItem("userInfo")||"{}")},actions:{},mutations:(se={},te()(se,"LOGIN",function(e,t){e.userInfo=t,localStorage.setItem("userInfo",ce()(t))}),te()(se,"LOGOUT",function(e){e.userInfo={},localStorage.removeItem("userInfo")}),se),getters:{}};n.default.use(r.a);var de=new r.a.Store({modules:{user:me}}),fe=a("zL8q"),pe=a.n(fe);n.default.use(s.a);var ge=new s.a({mode:"history",routes:[{path:"/",name:"Login",component:P,meta:{requireAuth:!1}},{path:"/main",name:"Main",component:F,meta:{requireAuth:!0}},{path:"/roleList",name:"RoleList",component:N,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/userList",name:"UserList",component:j,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/user/:id",name:"UserDetail",component:G,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/modifyPassword",name:"ModifyPassword",component:W,meta:{requireAuth:!0}},{path:"/menuList",name:"MenuList",component:Z,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/mealList",name:"MealList",component:re,meta:{requireAuth:!0,requireAdmin:!0}},{path:"/orderList",name:"OrderList",component:le,meta:{requireAuth:!0,requireAdmin:!0}}]});ge.beforeEach(function(e,t,a){e.meta.requireAuth?_("/auth/checkLogin").then(function(t){200!==t.code?a({path:"/",query:{redirect:e.fullPath}}):(e.meta.requireAdmin&&1!==t.data.role_id&&a({path:"/main"}),a())}).catch(function(t){t.message&&fe.Message.error(t.message),a({path:"/",query:{redirect:e.fullPath}})}):a()});var he=ge;a("uMhA"),a("tvR6");n.default.use(pe.a),n.default.config.productionTip=!1,new n.default({el:"#app",router:he,store:de,components:{App:o},template:"<App/>"})},"QxQ/":function(e,t){},R4VL:function(e,t){},V4Dg:function(e,t){},VC28:function(e,t){},VHQn:function(e,t){},XlyW:function(e,t){},b46R:function(e,t){},kmGr:function(e,t){},m1VC:function(e,t){},nhwv:function(e,t){},tvR6:function(e,t){},uMhA:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.7331ead01fea211bbdfe.js.map